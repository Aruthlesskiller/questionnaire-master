(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[9531],{34687:function(M){M.exports={container:"container___1sYa-",lang:"lang___l6cji",content:"content___2zk1-",top:"top___1C1Zi",header:"header___5xZ3f",logo:"logo___2hXsy",title:"title___1-xuF",desc:"desc___-njyT",main:"main___x4OjT",icon:"icon___rzGKO",other:"other___lLyaU",register:"register___11Twg",prefixIcon:"prefixIcon___23Xrx"}},29791:function(M,T,e){"use strict";var he=e(27400),G=e(36450),X=e(85893);T.Z=function(){var v,B,g=(0,he.a)(),V=g.system,oe=(v=V.setting)===null||v===void 0?void 0:v.copyright,$=[];if((B=V.setting)!==null&&B!==void 0&&B.recordNum){var z;$.push({key:"recordNumber",title:(z=V.setting)===null||z===void 0?void 0:z.recordNum,href:"https://beian.miit.gov.cn/",blankTarget:!0})}return(0,X.jsx)(G.qc,{copyright:oe||!1,links:$})}},68759:function(M,T,e){"use strict";e.r(T),e.d(T,{default:function(){return it}});var he=e(34792),G=e(48086),X=e(11849),v=e(39428),B=e(3182),g=e(94657),V=e(17462),oe=e(76772),$=e(29791),z=e(89366),Pe=e(2603),ue=e(21307),s=e(67294),b=e(42285),ze=e(73727),ke=e(27400),Oe=e(80582),xt=e(71194),De=e(50146),Fe=e(59879),Ke=e(43929),He=e(81354),k=e.n(He),pe=function(r){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"XwKsGlMcdPMEhR1B",h=k().enc.Utf8.parse(u),i=k().enc.Utf8.parse(r),W=k().AES.encrypt(i,h,{mode:k().mode.ECB,padding:k().pad.Pkcs7});return W.toString()},me=e(3980),Ue=e(9669),Ge=e.n(Ue),ye=Ge().create({timeout:4e4,headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json; charset=UTF-8"}});ye.interceptors.request.use(function(d){return d},function(d){Promise.reject(d)}),ye.interceptors.response.use(function(d){var r=d.data;return r});var Xe=function(r){return me.hi.post("/captcha/get",r)};function Ve(d){return ce.apply(this,arguments)}function ce(){return ce=(0,B.Z)((0,v.Z)().mark(function d(r){return(0,v.Z)().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",me.hi.post("/captcha/check",r));case 1:case"end":return h.stop()}},d)})),ce.apply(this,arguments)}var $e=e(79743),Qe=e.n($e),t=e(85893),O={mode:"fixed",vSpace:5,imgSize:{width:"310px",height:"200px"},barSize:{width:"310px",height:"40px"},setSize:{imgHeight:"200px",imgWidth:"310px",barHeight:"40px",barWidth:"310px"},blockSize:{width:"40px",height:"40px"}},Ye=function(r){var u=O.vSpace,h=O.blockSize,i=O.setSize,W=O.imgSize,N=O.barSize,le=r.isShow,D=r.captchaType,Q=D===void 0?"blockPuzzle":D,Y=r.transitionLeft,F=Y===void 0?"":Y,f=r.transitionWidth,P=f===void 0?"":f,de=r.verifyCaptcha,J=(0,s.useState)(""),q=(0,g.Z)(J,2),K=q[0],_=q[1],ee=(0,s.useState)(""),te=(0,g.Z)(ee,2),ae=te[0],w=te[1],p=(0,s.useState)("#1890ff"),m=(0,g.Z)(p,2),c=m[0],x=m[1],y=(0,s.useState)(!1),L=(0,g.Z)(y,2),I=L[0],S=L[1],re=(0,s.useState)(!1),fe=(0,g.Z)(re,2),n=fe[0],ve=fe[1],ot=(0,s.useState)(""),xe=(0,g.Z)(ot,2),Se=xe[0],H=xe[1],ut=(0,s.useState)("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),je=(0,g.Z)(ut,2),ct=je[0],Ce=je[1],U=(0,s.useRef)(!1),Ze=(0,s.useRef)(0),R=(0,s.useRef)(0),lt=(0,s.useState)(0),we=(0,g.Z)(lt,2),dt=we[0],Be=we[1],ft=(0,s.useState)(0),be=(0,g.Z)(ft,2),vt=be[0],Le=be[1],ge=(0,s.useRef)(0),Me=(0,s.useRef)(0),Ne=(0,s.useRef)(""),Ie=(0,s.useRef)("");(0,s.useEffect)(function(){return gt(),Re(),ht(),pt},[]);var gt=function(){for(var a=[],o="0123456789abcdef",C=0;C<36;C++)a[C]=o.substring(Math.floor(Math.random()*16),1);a[14]="4",a[19]=o.substring(Number(a[19])&3|8,1),a[8]=a[13]=a[18]=a[23]="-";var l="slider-".concat(a.join(""));localStorage.getItem("slider")||localStorage.setItem("slider",l)},ht=function(){window.addEventListener("touchmove",se),window.addEventListener("mousemove",se),window.addEventListener("touchend",ne),window.addEventListener("mouseup",ne)},pt=function(){window.removeEventListener("touchmove",se),window.removeEventListener("mousemove",se),window.removeEventListener("touchend",ne),window.removeEventListener("mouseup",ne)},Re=function(){Xe({ts:Date.now(),captchaType:Q,clientUid:localStorage.getItem("slider")}).then(function(a){if(a.success){var o=a.data||{},C=o.repCode,l=o.repData,E=o.repMsg,A=E===void 0?"":E;C==="0000"&&(Ne.current=l.token,Ie.current=l.secretKey,_(l.originalImageBase64),w(l.jigsawImageBase64)),C=="6201"&&(_(""),w(""),ve(!1),H(A),setTimeout(function(){H("")},1e3))}})},Ee=function(a){a=a||window.event;var o=a.touches?a.touches[0].pageX:a.clientX;Ze.current=Math.floor(o-ge.current),I==!1&&(Ce(""),U.current=!0,x("#1890ff"),a.stopPropagation())},se=function(a){if(a=a||window.event,U.current&&I==!1){var o=a.touches?a.touches[0].pageX:a.clientX,C=ge.current,l=o-C,E=parseInt(h.width),A=parseInt("".concat(E/2)),ie=Me.current-A-2;l>=ie&&(l=ie),l<=24&&(l=A),R.current=l-Ze.current,Be(R.current),Le(R.current)}},Ae=function(){Re(),R.current=0,Be(R.current),Le(R.current),Ce("\u5411\u53F3\u6ED1\u52A8\u5B8C\u6210\u9A8C\u8BC1"),x("#1890ff"),S(!1),U.current=!1},ne=function(){if(U.current&&I==!1){var a=Ne.current,o=Ie.current,C=parseInt("".concat(R.current))*310/parseInt(i.imgWidth),l=JSON.stringify({x:C,y:5});Ve({captchaType:Q,ts:Date.now(),token:a,pointJson:o?pe(l,o):l}).then(function(E){if(E.success){var A=E.data||{},ie=A.repCode,yt=A.repMsg;if(ie==="0000"){S(!0),ve(!0),H("\u9A8C\u8BC1\u6210\u529F");var We="".concat(a,"---").concat(l);Te(o?pe(We,o):We)}else S(!0),ve(!1),x("#d9534f"),H(yt||"\u9A8C\u8BC1\u5931\u8D25");setTimeout(function(){Ae(),H("")},1e3)}}),U.current=!1}},mt=function j(a){var o=a&&a.getBoundingClientRect().left,C=a&&a.offsetWidth;ge.current=o,Me.current=C,o===0&&setTimeout(function(){j(a)},20)},Te=function(a){de(!1,a)};return(0,t.jsx)(De.Z,{title:"\u8BF7\u5B8C\u6210\u5B89\u5168\u9A8C\u8BC1",visible:le,footer:!1,destroyOnClose:!0,keyboard:!1,maskClosable:!1,width:parseInt(W.width)+48,onCancel:function(){return Te()},bodyStyle:{padding:"12px 24px"},children:(0,t.jsx)("div",{className:"verifybox",children:(0,t.jsxs)("div",{style:{position:"relative"},className:"stop-user-select",children:[(0,t.jsx)("div",{className:"verify-img-out",style:{height:parseInt(i.imgHeight)+u},children:(0,t.jsxs)("div",{className:"verify-img-panel",style:{width:i.imgWidth,height:i.imgHeight},children:[(0,t.jsx)("div",{onClick:Ae,style:{height:32,width:32,lineHeight:"32px",borderRadius:32,backgroundColor:"rgb(0, 0, 0, 0.2)",textAlign:"center",position:"absolute",top:4,right:4},children:(0,t.jsx)(Fe.Z,{style:{color:"#fff",fontSize:"16px",fontWeight:800}})}),(0,t.jsx)("img",{alt:"",src:K?"data:image/png;base64,".concat(K):Qe(),style:{width:"100%",height:"100%",display:"block"}}),!!Se&&(0,t.jsx)("div",{className:"tips",children:(0,t.jsx)("span",{className:"verify-tips ".concat(n?"suc-bg":"err-bg"),children:Se})})]})}),(0,t.jsxs)("div",{className:"verify-bar-area",style:{width:i.imgWidth,height:N.height,lineHeight:N.height},ref:function(a){return mt(a)},children:[(0,t.jsx)("span",{className:"verify-msg",children:ct}),(0,t.jsx)("div",{className:"verify-left-bar",style:{width:"".concat(dt,"px")||0,height:N.height,transition:P},children:(0,t.jsxs)("div",{onMouseDown:Ee,onTouchStart:Ee,className:"verify-move-block",style:{width:h.height,height:h.height,backgroundColor:c,left:"".concat(vt,"px"),transition:F},children:[(0,t.jsx)(Ke.Z,{style:{color:"#fff"}}),(0,t.jsx)("div",{className:"verify-sub-block",style:{width:"".concat(Math.floor(parseInt(i.imgWidth)*48/310),"px"),height:i.imgHeight,top:"-".concat(parseInt(i.imgHeight)+u,"px"),backgroundSize:"".concat(i.imgWidth," ").concat(i.imgHeight)},children:(0,t.jsx)("img",{alt:"",src:"data:image/png;base64,".concat(ae),style:{width:"100%",height:"100%",display:"block"}})})]})})]})]})})})},Je=Ye,qe=e(5481),_e=e.n(qe),et=e(34687),Z=e.n(et),tt=e(98078),at="MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCNcRNGaRRWgxIA0R9dGcbnaSddYWZTy1rHN0LGK1stMmKWN7Rp3D4LRXKdX7OCO3QYTPWNnxAu2L4Vz4NpytMdAHVI5Mq5ls2sJbFGDZ8SNyXiVAZ/dnZ2178CJE9ZgqgN2ZS/M7/LYDUT4SASh8T1jBCVmKYstkuk7pixqdKSFwIDAQAB",rt=function(r,u){console.log(u);var h={log:!1},i=new tt.Z(h);return i.setPublicKey(u||at),i.encrypt(r)},St=function(r){var u=new JSEncrypt;return u.setPrivateKey(""),u.decrypt(r)},st=function(r){var u=r.content;return(0,t.jsx)(oe.Z,{style:{marginBottom:24},message:u,type:"error",showIcon:!0})},nt=function(r){var u,h=(0,s.useState)(!1),i=(0,g.Z)(h,2),W=i[0],N=i[1],le=(0,s.useState)(),D=(0,g.Z)(le,2),Q=D[0],Y=D[1],F=(0,ke.a)(),f=F.system,P=(0,b.YB)(),de=function(){var w=(0,B.Z)((0,v.Z)().mark(function p(){return(0,v.Z)().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:case"end":return c.stop()}},p)}));return function(){return w.apply(this,arguments)}}(),J=(0,s.useRef)(),q=(0,s.useState)(!1),K=(0,g.Z)(q,2),_=K[0],ee=K[1],te=function(){var w=(0,B.Z)((0,v.Z)().mark(function p(m,c){var x,y,L;return(0,v.Z)().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(ee(m),x=J.current.getFieldsValue(),y=x.username,L=x.password,!(y&&L&&c)){S.next=5;break}return S.next=5,ae({username:y,password:L,captchaVerification:c});case 5:N(!1);case 6:case"end":return S.stop()}},p)}));return function(m,c){return w.apply(this,arguments)}}(),ae=function(){var w=(0,B.Z)((0,v.Z)().mark(function p(m){var c,x,y,L,I,S,re;return(0,v.Z)().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,c=F.system.publicKey,n.next=4,F.login((0,X.Z)((0,X.Z)({},m),{},{password:rt(m.password,c)}));case 4:if(x=n.sent,!x.success){n.next=19;break}if(y=P.formatMessage({id:"pages.login.success",defaultMessage:"\u767B\u5F55\u6210\u529F\uFF01"}),G.default.success(y),!r.onOk){n.next=11;break}return r.onOk(),n.abrupt("return");case 11:return n.next=13,de();case 13:if(b.m8){n.next=15;break}return n.abrupt("return");case 15:return L=b.m8.location.query,I=L,S=I.redirect,b.m8.push(S||"/"),n.abrupt("return");case 19:Y(x.message&&"error"),n.next=26;break;case 22:n.prev=22,n.t0=n.catch(0),re=P.formatMessage({id:"pages.login.failure",defaultMessage:"\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01"}),G.default.error(re);case 26:N(!1);case 27:case"end":return n.stop()}},p,null,[[0,22]])}));return function(m){return w.apply(this,arguments)}}();return(0,t.jsxs)("div",{className:Z().container,children:[(0,t.jsx)("div",{className:Z().lang,"data-lang":!0,children:b.pD&&(0,t.jsx)(b.pD,{})}),(0,t.jsxs)("div",{className:Z().content,children:[(0,t.jsxs)("div",{className:Z().top,children:[(0,t.jsxs)("div",{className:Z().header,children:[(0,t.jsx)("img",{alt:"logo",className:Z().logo,src:f.avatar?"/api/public/preview/".concat(f==null?void 0:f.avatar):_e()}),(0,t.jsx)("span",{className:Z().title,children:f==null?void 0:f.name})]}),(0,t.jsx)("div",{className:Z().desc,children:f==null?void 0:f.description})]}),(0,t.jsx)("div",{className:Z().main,children:(0,t.jsxs)(ue.ZP,{formRef:J,initialValues:{autoLogin:!0},submitter:{searchConfig:{submitText:P.formatMessage({id:"pages.login.submit",defaultMessage:"\u767B\u5F55"})},render:function(p,m){return m.pop()},submitButtonProps:{loading:W,size:"large",style:{width:"100%"},htmlType:"submit"}},isKeyPressSubmit:!0,onFinish:function(){var w=(0,B.Z)((0,v.Z)().mark(function p(m){var c;return(0,v.Z)().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!W){y.next=2;break}return y.abrupt("return");case 2:(c=f.setting)!==null&&c!==void 0&&c.captchaEnabled?ee(!0):ae(m),N(!0);case 4:case"end":return y.stop()}},p)}));return function(p){return w.apply(this,arguments)}}(),children:[Q==="error"&&(0,t.jsx)(st,{content:P.formatMessage({id:"pages.login.accountLogin.errorMessage",defaultMessage:"\u8D26\u6237\u6216\u5BC6\u7801\u9519\u8BEF"})}),(0,t.jsx)(ue.V,{name:"username",fieldProps:{size:"large",prefix:(0,t.jsx)(z.Z,{className:Z().prefixIcon})},rules:[{required:!0,message:(0,t.jsx)(b._H,{id:"pages.login.username.required",defaultMessage:"\u8BF7\u8F93\u5165\u7528\u6237\u540D!"})}]}),(0,t.jsx)(ue.V.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(Pe.Z,{className:Z().prefixIcon})},rules:[{required:!0,message:(0,t.jsx)(b._H,{id:"pages.login.password.required",defaultMessage:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"})}]}),((u=f.registerInfo)===null||u===void 0?void 0:u.registerEnabled)&&(0,t.jsx)("div",{style:{marginBottom:24,display:"flex",justifyContent:"flex-end"},children:(0,t.jsx)(ze.rU,{to:"/user/register",children:(0,t.jsx)(b._H,{id:"pages.login.registerAccount",defaultMessage:"\u6CE8\u518C"})})})]})})]}),(0,t.jsx)(Je,{isShow:_,verifyCaptcha:te}),(0,t.jsx)($.Z,{})]})},it=(0,Oe.Pi)(nt)},5481:function(M,T,e){M.exports=e.p+"static/logo.efd90f0d.svg"},79743:function(M,T,e){M.exports=e.p+"static/default.aac93cd7.jpg"},42480:function(){}}]);
