(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[6527],{46502:function(I){I.exports={baseView:"baseView___3sRG3",left:"left___GavW0",right:"right___3-EXe",avatar_title:"avatar_title___13ztg",avatar:"avatar___1GisI",button_view:"button_view___o9apF",area_code:"area_code___3Tg4d",phone_number:"phone_number___1bV0u"}},41215:function(I){I.exports={main:"main___2yGev",leftMenu:"leftMenu___179-W",right:"right___2jdGg",title:"title___3cGwa"}},40603:function(I,R,r){"use strict";r.r(R),r.d(R,{default:function(){return ie}});var le=r(30887),U=r(28682),j=r(11849),N=r(94657),Z=r(67294),z=r(36450),oe=r(34792),b=r(48086),ce=r(43185),M=r(28525),de=r(57663),$=r(71577),h=r(39428),C=r(3182),G=r(84391),n=r(21307),K=r(3297),A=r(3980),B=r(27400),S=r(9761),L=r(46502),E=r.n(L),O=r(5481),T=r.n(O),e=r(85893),J=(0,S.Pi)(function(){var w=(0,B.a)(),s=w.user,v=function(){var p=(0,C.Z)((0,h.Z)().mark(function u(o){var c,d,l,i;return(0,h.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=o.onSuccess,d=o.onError,l=o.file,i=o.onProgress,A.hi.upload("/api/file/create",{file:l},function(a){i&&i({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&c&&(c(a.data),A.hi.updateUserInfo({avatar:a.data.id}).then(function(x){x.success&&(s.avatar=a.data.id)})),!a.success&&d){var y=new Error("Some error");d({event:y})}});case 2:case"end":return t.stop()}},u)}));return function(o){return p.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:E().avatar_title,children:"\u5934\u50CF"}),(0,e.jsx)("div",{className:E().avatar,children:s!=null&&s.avatar?(0,e.jsx)("img",{style:{borderRadius:"50%"},src:"/api/public/preview/".concat(s==null?void 0:s.avatar),alt:"avatar"}):(0,e.jsx)("img",{style:{borderRadius:"50%"},src:T(),alt:"avatar"})}),(0,e.jsx)(K.Z,{rotate:!0,shape:"round",cropperProps:{},children:(0,e.jsx)(M.Z,{showUploadList:!1,customRequest:v,children:(0,e.jsx)("div",{className:E().button_view,children:(0,e.jsxs)($.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u5934\u50CF"]})})})})]})}),Q=function(){var s=(0,B.a)(),v=s.user,p=s.loading,u=(0,Z.useMemo)(function(){return v},[]),o=function(){var c=(0,C.Z)((0,h.Z)().mark(function d(l){return(0,h.Z)().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:A.hi.updateUserInfo(l).then(function(t){t.success&&(s.user=(0,j.Z)((0,j.Z)({},v),l),b.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F"))});case 1:case"end":return F.stop()}},d)}));return function(l){return c.apply(this,arguments)}}();return(0,e.jsx)("div",{className:E().baseView,children:p?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:E().left,children:(0,e.jsxs)(n.ZP,{layout:"vertical",onFinish:o,submitter:{resetButtonProps:{style:{display:"none"}},submitButtonProps:{children:"\u66F4\u65B0\u57FA\u672C\u4FE1\u606F"}},initialValues:u,hideRequiredMark:!0,children:[(0,e.jsx)(n.V,{width:"md",name:"name",label:"\u59D3\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u6635\u79F0!"}]}),(0,e.jsx)(n.V,{name:"phone",label:"\u624B\u673A\u53F7",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8054\u7CFB\u7535\u8BDD!"}]}),(0,e.jsx)(n.V,{width:"md",name:"email",label:"\u90AE\u7BB1",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u60A8\u7684\u90AE\u7BB1!"}]}),(0,e.jsx)(n.$J,{name:"profile",label:"\u4E2A\u4EBA\u7B80\u4ECB",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4E2A\u4EBA\u7B80\u4ECB!"}],placeholder:"\u4E2A\u4EBA\u7B80\u4ECB"})]})}),(0,e.jsx)("div",{className:E().right,children:(0,e.jsx)(J,{})})]})})},W=(0,S.Pi)(Q),ve=r(54421),P=r(38272),fe=r(77576),X=r(12028),Y=function(){var s=function(){var u=(0,e.jsx)(X.Z,{checkedChildren:"\u5F00",unCheckedChildren:"\u5173",defaultChecked:!0});return[{title:"\u8D26\u6237\u5BC6\u7801",description:"\u5176\u4ED6\u7528\u6237\u7684\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[u]},{title:"\u7CFB\u7EDF\u6D88\u606F",description:"\u7CFB\u7EDF\u6D88\u606F\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[u]},{title:"\u5F85\u529E\u4EFB\u52A1",description:"\u5F85\u529E\u4EFB\u52A1\u5C06\u4EE5\u7AD9\u5185\u4FE1\u7684\u5F62\u5F0F\u901A\u77E5",actions:[u]}]},v=s();return(0,e.jsx)(Z.Fragment,{children:(0,e.jsx)(P.ZP,{itemLayout:"horizontal",dataSource:v,renderItem:function(u){return(0,e.jsx)(P.ZP.Item,{actions:u.actions,children:(0,e.jsx)(P.ZP.Item.Meta,{title:u.title,description:u.description})})}})})},H=Y,q=function(){var s=(0,Z.useState)(!1),v=(0,N.Z)(s,2),p=v[0],u=v[1],o=(0,B.a)(),c=o.user,d=(0,A.m2)(),l=(0,Z.useRef)(),i=function(){return[{title:"\u8D26\u6237\u5BC6\u7801",actions:[(0,e.jsx)("a",{onClick:function(){return u(!0)},children:"\u4FEE\u6539"},"Modify")]}]},F=i();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(P.ZP,{itemLayout:"horizontal",dataSource:F,renderItem:function(a){return(0,e.jsx)(P.ZP.Item,{actions:a.actions,children:(0,e.jsx)(P.ZP.Item.Meta,{title:a.title})})}}),(0,e.jsxs)(n.Yr,{title:"\u4FEE\u6539\u5BC6\u7801",visible:p,formRef:l,width:400,modalProps:{onCancel:function(){u(!1)},okText:"\u786E\u8BA4\u4FEE\u6539",maskClosable:!1},onFinish:function(){var t=(0,C.Z)((0,h.Z)().mark(function a(y){return(0,h.Z)().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:d.saveOrUpdateUser((0,j.Z)({id:c==null?void 0:c.userId},y)).then(function(g){g.success?(u(!1),b.default.success("\u5BC6\u7801\u4FEE\u6539\u6210\u529F")):b.default.error(g.message)});case 1:case"end":return m.stop()}},a)}));return function(a){return t.apply(this,arguments)}}(),children:[(0,e.jsx)(n.V.Password,{label:"\u65E7\u5BC6\u7801",name:"oldPassword",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5F53\u524D\u767B\u5F55\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(n.V.Password,{name:"password",label:"\u65B0\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801\uFF01"}]}),(0,e.jsx)(n.V.Password,{name:"confirmPassword",label:"\u786E\u8BA4\u5BC6\u7801",fieldProps:{size:"large"},placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{validator:function(a,y){var x,m,g=(x=l.current)===null||x===void 0?void 0:x.getFieldValue("password");return y?g!==y&&(m="\u4E24\u6B21\u5BC6\u7801\u8F93\u5165\u4E0D\u4E00\u81F4"):m="\u8BF7\u518D\u6B21\u8F93\u5165\u5BC6\u7801",m?Promise.reject(new Error(m)):Promise.resolve()}}]})]})]})},_=(0,S.Pi)(q),ee=(0,S.Pi)(function(){var w=(0,B.a)(),s=w.system,v=function(){var p=(0,C.Z)((0,h.Z)().mark(function u(o){var c,d,l,i;return(0,h.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:c=o.onSuccess,d=o.onError,l=o.file,i=o.onProgress,A.hi.upload("/api/file/create",{file:l},function(a){i&&i({percent:a.loaded/a.total*100})}).then(function(a){if(a.success&&c&&(c(a.data),A.hi.updateSysInfo({id:s==null?void 0:s.id,avatar:a.data.id}).then(function(x){x.success&&(s.avatar=a.data.id)})),!a.success&&d){var y=new Error("Some error");d({event:y})}});case 2:case"end":return t.stop()}},u)}));return function(o){return p.apply(this,arguments)}}();return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:E().avatar_title,children:"\u7CFB\u7EDF\u56FE\u6807"}),(0,e.jsx)("div",{className:E().avatar,children:s.avatar?(0,e.jsx)("img",{src:"/api/public/preview/".concat(s==null?void 0:s.avatar),alt:"avatar"}):(0,e.jsx)("img",{src:T()})}),(0,e.jsx)(M.Z,{showUploadList:!1,customRequest:v,children:(0,e.jsx)("div",{className:E().button_view,children:(0,e.jsxs)($.Z,{children:[(0,e.jsx)(G.Z,{}),"\u66F4\u6362\u56FE\u6807"]})})})]})}),ae=function(){var s=(0,B.a)(),v=s.system,p=s.loading,u=(0,A.m2)(),o=u.roles;(0,Z.useEffect)(function(){u.loadRoles({current:1,pageSize:1024})},[u]);var c=function(){var d=(0,C.Z)((0,h.Z)().mark(function l(i){return(0,h.Z)().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",A.hi.updateSysInfo((0,j.Z)((0,j.Z)({},v),i)).then(function(a){a.success&&(s.system=(0,j.Z)((0,j.Z)((0,j.Z)({},v),i),{},{avatar:v.avatar}),b.default.success("\u66F4\u65B0\u57FA\u672C\u4FE1\u606F\u6210\u529F"))}));case 1:case"end":return t.stop()}},l)}));return function(i){return d.apply(this,arguments)}}();return(0,e.jsx)("div",{className:E().baseView,children:p?null:(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:E().left,children:(0,e.jsxs)(n.ZP,{initialValues:v,onFinish:function(){var d=(0,C.Z)((0,h.Z)().mark(function l(i){var F;return(0,h.Z)().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,c(i);case 2:F=a.sent;case 3:case"end":return a.stop()}},l)}));return function(l){return d.apply(this,arguments)}}(),children:[(0,e.jsx)(n.V,{width:"md",name:"name",label:(0,e.jsxs)("span",{children:["\u7CFB\u7EDF\u540D\u79F0(",(0,e.jsx)("a",{href:"https://surveyking.cn/open-source/changelog",target:"_blank",rel:"noreferrer",children:"\u7248\u672C\u53F7v1.8.2"}),")"]}),required:!0,rules:[{required:!0,message:"\u7CFB\u7EDF\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,e.jsx)(n.V,{name:"description",label:"\u63CF\u8FF0\u4FE1\u606F"}),(0,e.jsx)(n.V,{name:["setting","copyright"],label:"\u7248\u6743\u4FE1\u606F"}),(0,e.jsx)(n.V,{name:["setting","recordNum"],label:"\u5907\u6848\u53F7"}),(0,e.jsx)(n.lG,{name:["registerInfo","registerEnabled"],label:"\u5F00\u542F\u6CE8\u518C"}),(0,e.jsx)(n.ie,{name:[["registerInfo","registerEnabled"]],children:function(l){var i=l.registerInfo;return i!=null&&i.registerEnabled?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n._I,{mode:"multiple",options:o.map(function(F){return{label:F.name,value:F.id}}),width:"md",name:["registerInfo","roles"],label:"\u6CE8\u518C\u7528\u6237\u53EF\u9009\u62E9\u89D2\u8272\u5217\u8868"}),(0,e.jsx)(n.lG,{name:["registerInfo","strongPasswordEnabled"],label:"\u5F00\u542F\u5F3A\u5BC6\u7801\u9A8C\u8BC1"})]}):(0,e.jsx)(e.Fragment,{})}}),(0,e.jsx)(n.lG,{name:["setting","captchaEnabled"],label:"\u5F00\u542F\u9A8C\u8BC1\u7801"})]})}),(0,e.jsx)("div",{className:E().right,children:(0,e.jsx)(ee,{})})]})})},re=(0,S.Pi)(ae),se=function(){var s=(0,B.a)(),v=s.system,p=s.loading,u=(0,Z.useState)(),o=(0,N.Z)(u,2),c=o[0],d=o[1],l=(0,Z.useState)(!1),i=(0,N.Z)(l,2),F=i[0],t=i[1];(0,Z.useEffect)(function(){var x=function(){var m=(0,C.Z)((0,h.Z)().mark(function g(){var D;return(0,h.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return t(!0),f.prev=1,f.next=4,A.hi.getAiSetting();case 4:D=f.sent,d(D||{}),f.next=12;break;case 8:f.prev=8,f.t0=f.catch(1),console.error("Failed to load AI setting:",f.t0),d({});case 12:return f.prev=12,t(!1),f.finish(12);case 15:case"end":return f.stop()}},g,null,[[1,8,12,15]])}));return function(){return m.apply(this,arguments)}}();x()},[]);var a=function(){var x=(0,C.Z)((0,h.Z)().mark(function m(g){return(0,h.Z)().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.abrupt("return",A.hi.updateSysInfo((0,j.Z)((0,j.Z)({},v),g)).then(function(f){f.success&&(s.system=(0,j.Z)((0,j.Z)((0,j.Z)({},v),g),{},{avatar:v.avatar}),d(g.aiSetting||{}),b.default.success("\u66F4\u65B0AI\u914D\u7F6E\u6210\u529F"))}));case 1:case"end":return V.stop()}},m)}));return function(g){return x.apply(this,arguments)}}(),y=[{label:"Pro/deepseek-ai/DeepSeek-V3",value:"Pro/deepseek-ai/DeepSeek-V3"},{label:"deepseek-ai/DeepSeek-R1(\u63A8\u7406\u6A21\u578B)",value:"deepseek-ai/DeepSeek-R1"},{label:"deepseek-ai/DeepSeek-R1-0528-Qwen3-8B(\u514D\u8D39)",value:"deepseek-ai/DeepSeek-R1-0528-Qwen3-8B"}];return(0,e.jsx)("div",{className:E().baseView,children:p||F?null:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)("div",{className:E().left,children:(0,e.jsxs)(n.ZP,{initialValues:{aiSetting:c},onFinish:function(){var x=(0,C.Z)((0,h.Z)().mark(function m(g){var D;return(0,h.Z)().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,a(g);case 2:D=f.sent;case 3:case"end":return f.stop()}},m)}));return function(m){return x.apply(this,arguments)}}(),children:[(0,e.jsx)(n.lG,{name:["aiSetting","enabled"],label:"\u542F\u7528AI\u529F\u80FD",extra:(0,e.jsxs)(e.Fragment,{children:["\u5F00\u542F\u540E\uFF0C\u7528\u6237\u53EF\u4EE5\u4F7F\u7528AI\u667A\u80FD\u521B\u5EFA\u95EE\u5377\u529F\u80FD"," ",(0,e.jsx)("a",{target:"_blank",href:"https://surveyking.cn/open-source/docs/ai",rel:"noreferrer",children:"\u67E5\u770B\u6587\u6863"})]})}),(0,e.jsx)(n.ie,{name:[["aiSetting","enabled"]],children:function(m){var g=m.aiSetting;return g!=null&&g.enabled?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(n._I,{mode:"tags",options:y,width:"lg",name:["aiSetting","models"],label:"\u53EF\u7528AI\u6A21\u578B",placeholder:"\u8BF7\u8F93\u5165\u6216\u9009\u62E9AI\u6A21\u578B\uFF0C\u652F\u6301\u81EA\u5B9A\u4E49\u6A21\u578B\u540D\u79F0",extra:"\u53EF\u4EE5\u4ECE\u9884\u8BBE\u9009\u9879\u4E2D\u9009\u62E9\uFF0C\u4E5F\u53EF\u4EE5\u81EA\u7531\u8F93\u5165\u81EA\u5B9A\u4E49\u6A21\u578B\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u81F3\u5C11\u8F93\u5165\u4E00\u4E2AAI\u6A21\u578B"}]}),(0,e.jsx)(n.V.Password,{width:"lg",name:["aiSetting","token"],label:"API Token",placeholder:"\u8BF7\u8F93\u5165AI\u670D\u52A1\u7684API Token",extra:"\u7528\u4E8E\u8C03\u7528AI\u670D\u52A1\u7684\u8BA4\u8BC1\u4EE4\u724C",rules:[{required:!0,message:"API Token\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,e.jsx)(n.$J,{name:["aiSetting","prompt"],label:"\u7CFB\u7EDF\u63D0\u793A\u8BCD",placeholder:"\u8BF7\u8F93\u5165AI\u52A9\u624B\u7684\u7CFB\u7EDF\u63D0\u793A\u8BCD",extra:"\u7528\u4E8E\u6307\u5BFCAI\u5982\u4F55\u751F\u6210\u95EE\u5377\u5185\u5BB9\u7684\u7CFB\u7EDF\u63D0\u793A\uFF0C\u7559\u7A7A\u5C06\u4F7F\u7528\u9ED8\u8BA4\u63D0\u793A",fieldProps:{rows:6,maxLength:2e3,showCount:!0}})]}):(0,e.jsx)(e.Fragment,{})}})]})})})})},te=(0,S.Pi)(se),ue=r(41215),k=r.n(ue),ne=function(){var s=(0,B.a)(),v=s.isAdmin,p={base:"\u57FA\u672C\u8BBE\u7F6E",security:"\u5B89\u5168\u8BBE\u7F6E",ai:"AI\u8BBE\u7F6E",appInfo:"\u7CFB\u7EDF\u8BBE\u7F6E"},u=(0,Z.useState)({mode:"inline",selectKey:"base"}),o=(0,N.Z)(u,2),c=o[0],d=o[1],l=(0,Z.useRef)(),i=function(){return Object.keys(p).filter(function(a){return!(a==="appInfo"&&!v)}).map(function(a){return{label:p[a],key:a}})},F=function(){var a=c.selectKey;switch(a){case"base":return(0,e.jsx)(W,{});case"security":return(0,e.jsx)(_,{});case"notification":return(0,e.jsx)(H,{});case"appInfo":return(0,e.jsx)(re,{});case"ai":return(0,e.jsx)(te,{});default:return null}};return(0,e.jsx)(z.fT,{children:(0,e.jsxs)("div",{className:k().main,ref:function(a){a&&(l.current=a)},children:[(0,e.jsx)("div",{className:k().leftMenu,children:(0,e.jsx)(U.Z,{mode:c.mode,selectedKeys:[c.selectKey],onClick:function(a){var y=a.key;d((0,j.Z)((0,j.Z)({},c),{},{selectKey:y}))},items:i()})}),(0,e.jsxs)("div",{className:k().right,children:[(0,e.jsx)("div",{className:k().title,children:p[c.selectKey]}),F()]})]})})},ie=(0,S.Pi)(ne)},5481:function(I,R,r){I.exports=r.p+"static/logo.efd90f0d.svg"}}]);
