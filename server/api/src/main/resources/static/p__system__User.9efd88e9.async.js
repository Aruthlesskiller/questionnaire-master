(self.webpackChunksurvey_king=self.webpackChunksurvey_king||[]).push([[7915],{86468:function(De,ee,e){"use strict";e.d(ee,{lq:function(){return oe},FQ:function(){return ue},fl:function(){return G}});var Pe=e(43358),ne=e(34041),re=e(20228),N=e(11382),U=e(11849),J=e(94657),K=e(93224),V=e(3980),te=e(21307),L=e(67294),Z=e(85893),ae=["fps","fetcher","width","className","defaultOptions","readonly","value"],oe=function(l){var D=l.fps,X=D===void 0?30:D,a=l.fetcher,w=l.width,o=l.className,I=l.defaultOptions,P=l.readonly,r=l.value,s=(0,K.Z)(l,ae),O=(0,L.useState)(!1),y=(0,J.Z)(O,2),E=y[0],v=y[1],R=(0,L.useState)(I||[]),T=(0,J.Z)(R,2),j=T[0],p=T[1],S=L.useRef(0),A=G(w),C=(0,V.zE)(function(Y){v(!0),p([]),S.current+=1;var M=S.current;l.fetcher(Y).then(function(h){M===S.current&&(p(h),v(!1))})},X);if(P){var u;return(0,Z.jsx)(te.ZP.Item,(0,U.Z)((0,U.Z)({},s),{},{children:(0,Z.jsx)("span",{children:(u=j.find(function(Y){return Y.value===r}))===null||u===void 0?void 0:u.label})}))}return(0,Z.jsx)(te.ZP.Item,(0,U.Z)((0,U.Z)({},s),{},{children:(0,Z.jsx)(ne.Z,(0,U.Z)({showSearch:!0,placeholder:l.placeholder,filterOption:!1,onSearch:C,allowClear:!0,onFocus:function(){return C("")},onClear:function(){return C("")},loading:E,notFoundContent:E?(0,Z.jsx)(N.Z,{size:"small"}):null,options:j},A))}))},de=e(62999),ie=e(54680),W=["width","className","treeData","placeholder","readonly","value"],ue=function(l){var D=l.width,X=l.className,a=l.treeData,w=l.placeholder,o=l.readonly,I=l.value,P=(0,K.Z)(l,W),r=G(D);if(o){var s;return(0,Z.jsx)(te.ZP.Item,(0,U.Z)((0,U.Z)({},P),{},{children:(0,Z.jsx)("span",{children:(s=(0,V.hE)(a,I,"key"))===null||s===void 0?void 0:s.title})}))}return(0,Z.jsx)(te.ZP.Item,(0,U.Z)((0,U.Z)({},P),{},{children:(0,Z.jsx)(ie.Z,(0,U.Z)({dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:a,placeholder:w,treeDefaultExpandAll:!0},r))}))};function G(B){if(!B)return{};if(typeof B=="number")return{style:{width:B}};if(typeof B=="string")return{className:"pro-field ".concat(typeof B=="string"?"pro-field-".concat(B):"")}}},79871:function(De,ee,e){"use strict";e.d(ee,{G:function(){return I},y:function(){return o}});var Pe=e(57663),ne=e(71577),re=e(39428),N=e(3182),U=e(34792),J=e(48086),K=e(71194),V=e(50146),te=e(94657),L=e(83279),Z=e(3980),ae=e(87588),oe=e(51042),de=e(16894),ie=e(9761),W=e(60780),ue=e.n(W),G=e(67294),B=e(11849),l=e(86468),D=e(21307),X=e(80582),a=e(85893),w=(0,X.Pi)(function(P){var r=P.dept,s=P.onClose,O=P.onOk,y=(0,Z.m2)(),E=(0,G.useRef)(),v=!!(r!=null&&r.id),R=y.depts,T=(0,G.useMemo)(function(){return ue()(R.map(function(j){return{value:j.id,title:j.name,key:j.id,parentId:j.parentId}}),{parentProperty:"parentId",customID:"value"})},[R]);return(0,a.jsxs)(D.aN,{title:v?"\u4FEE\u6539\u7EC4\u7EC7\u673A\u6784":"\u65B0\u5EFA\u7EC4\u7EC7\u673A\u6784",formRef:E,initialValues:(0,B.Z)({},r),visible:!0,drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){s()}},onFinish:function(){var j=(0,N.Z)((0,re.Z)().mark(function p(S){var A;return(0,re.Z)().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,y.saveOrUpdateDept((0,B.Z)((0,B.Z)({},r),S));case 2:A=u.sent,A.success?O():J.default.error("\u4FDD\u5B58\u5931\u8D25");case 4:case"end":return u.stop()}},p)}));return function(p){return j.apply(this,arguments)}}(),children:[(0,a.jsxs)(D.ZP.Group,{children:[(!r||r&&r.id!=="1")&&R.length>0&&(0,a.jsx)(l.FQ,{name:"parentId",width:"md",treeData:T,label:"\u4E0A\u7EA7\u90E8\u95E8",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",required:!0,value:r==null?void 0:r.id,rules:[{required:!0,message:"\u4E0A\u7EA7\u90E8\u95E8\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,a.jsx)(D.V,{name:"code",width:"md",label:"\u7F16\u7801",placeholder:"\u8BF7\u8F93\u5165\u7F16\u7801",required:!0,rules:[{required:!0,message:"\u7F16\u7801\u4E0D\u80FD\u4E3A\u7A7A"}]})]}),(0,a.jsxs)(D.ZP.Group,{children:[(0,a.jsx)(D.V,{name:"name",width:"md",label:"\u5168\u79F0",id:"form-name",placeholder:"\u8BF7\u8F93\u5165\u5168\u79F0",required:!0,rules:[{required:!0,message:"\u5168\u79F0\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,a.jsx)(D.V,{name:"shortName",width:"md",label:"\u7B80\u79F0",id:"form-name",placeholder:"\u8BF7\u8F93\u5165\u7B80\u79F0",required:!0})]}),(0,a.jsx)(D.ZP.Group,{children:(0,a.jsx)(l.lq,{fps:2,name:"managerId",width:"md",label:"\u8D1F\u8D23\u4EBA",placeholder:"\u8F93\u5165\u59D3\u540D\u68C0\u7D22",value:r==null?void 0:r.managerId,defaultOptions:v?[{label:r.managerName,value:r.managerId}]:void 0,fetcher:function(p){return Z.hi.loadUsers({name:p}).then(function(S){return S.list.map(function(A){return{label:A.name,value:A.id}})})}})}),(0,a.jsx)(D.ZP.Group,{children:(0,a.jsx)(D.$J,{name:"remark",width:690,label:"\u5907\u6CE8",id:"form-name",placeholder:"\u8BF7\u8F93\u5165\u5907\u6CE8"})})]})});function o(P,r){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"id",O=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!r)return P;for(var y=(0,L.Z)(P);y.length;){var E=y[O?"pop":"shift"]();if(E&&E[s]===r)return[E];E!=null&&E.children&&y.push.apply(y,(0,L.Z)(E.children))}return null}var I=(0,ie.Pi)(function(P){var r=P.selectedDept,s=(0,Z.m2)(),O=s.loading,y=(0,G.useRef)(),E=(0,G.useState)({visible:!1}),v=(0,te.Z)(E,2),R=v[0],T=v[1],j=o(ue()(s.depts,{customID:"id",parentProperty:"parentId"}),r),p=[{title:"\u673A\u6784\u540D\u79F0",dataIndex:"name"},{title:"\u673A\u6784\u7B80\u79F0",dataIndex:"shortName",search:!1,width:200},{title:"\u8D1F\u8D23\u4EBA",dataIndex:"managerName",search:!1,width:150},{title:"\u64CD\u4F5C",valueType:"option",render:function(A,C){return[(0,a.jsx)("a",{onClick:function(){return T({visible:!0,current:C})},children:"\u7F16\u8F91"},"edit"),(0,a.jsx)("a",{onClick:function(){if(C.id==="1"){V.Z.info({title:"\u63D0\u793A",content:"\u5185\u7F6E\u673A\u6784\u4E0D\u80FD\u5220\u9664"});return}if(C.children&&C.children.length>0){J.default.error("\u8BF7\u5148\u5220\u9664\u5B50\u673A\u6784\uFF01");return}V.Z.confirm({title:"\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u673A\u6784?",icon:(0,a.jsx)(ae.Z,{}),onOk:function(){s.deleteDept(C.id)}})},children:"\u5220\u9664"},"delete")]}}];return(0,a.jsxs)("div",{children:[(0,a.jsx)(de.ZP,{columns:p,actionRef:y,loading:O,bordered:!0,dataSource:j,request:(0,N.Z)((0,re.Z)().mark(function S(){return(0,re.Z)().wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.abrupt("return",s.loadDepts());case 1:case"end":return C.stop()}},S)})),columnsState:{persistenceKey:"pro-table-dept",persistenceType:"localStorage"},rowKey:"id",search:!1,scroll:{x:650},pagination:!1,dateFormatter:"string",headerTitle:"\u673A\u6784\u7BA1\u7406",toolBarRender:function(){return[(0,a.jsx)(ne.Z,{icon:(0,a.jsx)(oe.Z,{}),type:"primary",onClick:function(){T({visible:!0})},children:"\u65B0\u5EFA"},"button")]}}),R.visible&&(0,a.jsx)(w,{onOk:function(){T({visible:!1})},dept:R.current,readonly:R.readonly,onClose:function(){return T({visible:!1})}})]})})},40017:function(De,ee,e){"use strict";e.d(ee,{A:function(){return P}});var Pe=e(58024),ne=e(91894),re=e(32157),N=e(38614),U=e(34792),J=e(48086),K=e(49111),V=e(19650),te=e(22385),L=e(94199),Z=e(94657),ae=e(83279),oe=e(3980),de=e(81162),ie=e(17828),W=e(59879),ue=e(54734),G=e(82029),B=e(55725),l=e(9761),D=e(60780),X=e.n(D),a=e(67294),w=e(79871),o=e(85893);function I(r){var s=[];return r.forEach(function(O){O.children&&(s.push(O.key),s.push.apply(s,(0,ae.Z)(I(O.children))))}),s}var P=(0,l.Pi)(function(r){var s=(0,oe.m2)(),O=s.depts;(0,a.useEffect)(function(){s.loadDepts()},[s]);var y=(0,a.useMemo)(function(){return X()(O.map(function(M){return{title:M.name,key:M.id,parentId:M.parentId}}),{parentProperty:"parentId",customID:"key"})},[O]),E=(0,a.useState)([]),v=(0,Z.Z)(E,2),R=v[0],T=v[1],j=(0,a.useState)(!0),p=(0,Z.Z)(j,2),S=p[0],A=p[1],C=(0,a.useMemo)(function(){return I(y)},[y]),u=function(h){T(h),A(!1)},Y=function(h){h.length>0?r.onSelect(h[0]):r.onSelect(void 0)};return(0,o.jsx)(ne.Z,{title:"\u7EC4\u7EC7\u673A\u6784",extra:(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)(V.Z,{children:[R.length>0?(0,o.jsx)(L.Z,{title:"\u6298\u53E0\u6240\u6709",children:(0,o.jsx)(de.Z,{style:{cursor:"pointer"},onClick:function(){return T([])}})}):(0,o.jsx)(L.Z,{title:"\u5C55\u5F00\u6240\u6709",children:(0,o.jsx)(ie.Z,{style:{cursor:"pointer"},onClick:function(){return T(C)}})}),(0,o.jsx)(L.Z,{title:"\u5237\u65B0",children:(0,o.jsx)(W.Z,{style:{cursor:"pointer"},onClick:function(){return s.loadDepts()}})})]})}),children:(0,o.jsx)(N.Z,{expandedKeys:R,onExpand:u,draggable:!0,autoExpandParent:S,onSelect:Y,showIcon:!0,treeData:y,onDrop:function(h){if(h.dragNode.pos!=="".concat(h.node.pos,"-0")){if(h.node.parentId!==h.dragNode.parentId&&h.dragNode.parentId!==h.node.key){J.default.error("\u53EA\u80FD\u6539\u53D8\u540C\u7EA7\u673A\u6784\u7684\u987A\u5E8F");return}var t=h.dragNode.parentId,ye=(0,w.y)(y,t,"key");if(ye){var Ee,ce=(Ee=ye[0].children)===null||Ee===void 0?void 0:Ee.map(function(ve){return ve.key}),Ce=h.dragNode.key,je=ce.indexOf(Ce);ce.splice(je,1,""),ce.splice(h.dropPosition,0,Ce),s.sortDept(ce.filter(function(ve){return ve}))}}},icon:function(h){var t=h.expanded;return t?(0,o.jsx)(ue.Z,{}):!h.data.children||h.data.children.length===0?(0,o.jsx)(G.Z,{}):(0,o.jsx)(B.Z,{})}})})})},87113:function(De,ee,e){"use strict";e.r(ee),e.d(ee,{default:function(){return Te}});var Pe=e(13062),ne=e(71230),re=e(57663),N=e(71577),U=e(66456),J=e(94132),K=e(39428),V=e(3182),te=e(89032),L=e(15746),Z=e(59250),ae=e(13013),oe=e(30887),de=e(28682),ie=e(34792),W=e(48086),ue=e(47673),G=e(77808),B=e(71194),l=e(50146),D=e(49111),X=e(19650),a=e(71153),w=e(60331),o=e(94657),I=e(3980),P=e(34804),r=e(51042),s=e(84391),O=e(36450),y=e(16894),E=e(80582),v=e(67294),R=e(40017),T=e(43358),j=e(34041),p=e(11849),S=e(62999),A=e(54680),C=e(86468),u=e(21307),Y=e(50727),M=e(60780),h=e.n(M),t=e(85893),ye=(0,E.Pi)(function(z){var Q,m=z.user,fe=z.onClose,le=z.onOk,H=(0,I.m2)(),k=(0,v.useRef)(),me=m==null||(Q=m.roles)===null||Q===void 0?void 0:Q.map(function(c){return c.id}),$=!!(m!=null&&m.id),se=H.depts,b=H.positions,he=(0,v.useState)(function(){var c;return(m==null||(c=m.userPositions)===null||c===void 0?void 0:c.map(function(F){return F.id}))||[]}),q=(0,o.Z)(he,2),_=q[0],Fe=q[1],ge=(0,v.useMemo)(function(){return h()(se.map(function(c){return{value:c.id,title:c.name,key:c.id,parentId:c.parentId}}),{parentProperty:"parentId",customID:"value"})},[se]);(0,v.useEffect)(function(){b.length===0&&H.loadPositions({pageSize:1024})},[]);var Ie=[{title:"\u673A\u6784\u540D\u79F0",dataIndex:"deptId",width:"30%",renderFormItem:function(F,x,f){var n=x.type,i=x.defaultRender,g=x.fieldProps;return n==="form"?(0,t.jsx)(A.Z,(0,p.Z)((0,p.Z)({allowClear:!0,treeData:ge},g),{},{placeholder:"\u8BF7\u9009\u62E9\u673A\u6784"})):i(F)}},{title:"\u5C97\u4F4D\u540D\u79F0",dataIndex:"positionId",width:"50%",renderFormItem:function(F,x,f){var n=x.type,i=x.defaultRender;return n==="form"?(0,t.jsx)(j.Z,{options:b.map(function(g){return{label:g.name,value:g.id}}),placeholder:"\u8BF7\u9009\u62E9\u5C97\u4F4D"}):i(F)}},{title:"\u64CD\u4F5C",valueType:"option",width:200}];return(0,t.jsxs)(u.aN,{title:$?"\u4FEE\u6539\u7528\u6237":"\u65B0\u5EFA\u7528\u6237",formRef:k,open:!0,initialValues:(0,p.Z)((0,p.Z)({},m),{},{roles:me}),drawerProps:{forceRender:!0,destroyOnClose:!0,onClose:function(){fe()}},onFinish:function(){var c=(0,V.Z)((0,K.Z)().mark(function F(x){var f;return(0,K.Z)().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,H.saveOrUpdateUser((0,p.Z)((0,p.Z)({},m),x));case 2:f=i.sent,f.success&&le();case 4:case"end":return i.stop()}},F)}));return function(F){return c.apply(this,arguments)}}(),children:[(0,t.jsxs)(u.ZP.Group,{children:[(0,t.jsx)(u.V,{name:"name",width:"md",label:"\u7528\u6237\u540D",tooltip:"\u6700\u957F\u4E3A 24 \u4F4D",id:"form-name",placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0",required:!0,rules:[{required:!0,message:"\u7528\u6237\u540D\u4E0D\u80FD\u4E3A\u7A7A"}]}),(0,t.jsx)(u.V,{width:"md",name:"username",label:"\u767B\u5F55\u540D",placeholder:"\u8BF7\u8F93\u5165\u767B\u5F55\u8D26\u6237\u540D\u79F0",rules:[{required:!0,message:"\u767B\u5F55\u540D\u4E0D\u80FD\u4E3A\u7A7A"},{validator:function(){var c=(0,V.Z)((0,K.Z)().mark(function x(f,n){var i;return(0,K.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(n!==(m==null?void 0:m.username)){d.next=2;break}return d.abrupt("return");case 2:return d.next=4,I.hi.checkUsernameExist(n);case 4:if(i=d.sent,!i){d.next=7;break}throw new Error("\u767B\u5F55\u540D\u5DF2\u5B58\u5728!");case 7:case"end":return d.stop()}},x)}));function F(x,f){return c.apply(this,arguments)}return F}()}],required:!0})]}),!$&&(0,t.jsxs)(u.ZP.Group,{children:[(0,t.jsx)(u.V.Password,{width:"md",name:"password",label:"\u8F93\u5165\u5BC6\u7801",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",rules:[{required:!$,message:"\u8BF7\u8F93\u5165\u5BC6\u7801!"}],required:!$}),(0,t.jsx)(u.V.Password,{width:"md",name:"rePassword",label:"\u786E\u8BA4\u5BC6\u7801",placeholder:"\u518D\u6B21\u8F93\u5165\u5BC6\u7801",rules:[{required:!$,message:"\u786E\u8BA4\u5BC6\u7801\u4E0D\u80FD\u4E3A\u7A7A!"},function(c){var F=c.getFieldValue;return{validator:function(f,n){return!n||F("password")===n?Promise.resolve():Promise.reject(new Error("\u4E24\u6B21\u8F93\u5165\u5BC6\u7801\u4E0D\u4E00\u81F4!"))}}}],required:!$})]}),(0,t.jsxs)(u.ZP.Group,{children:[(0,t.jsx)(u._I,{options:[{value:"M",label:"\u7537"},{value:"F",label:"\u5973"}],width:"md",name:"gender",label:"\u6027\u522B"}),(0,t.jsx)(u._I,{required:!0,options:[{value:1,label:"\u6FC0\u6D3B"},{value:0,label:"\u5931\u6D3B"}],width:"md",name:"status",label:"\u72B6\u6001"})]}),(0,t.jsxs)(u.ZP.Group,{children:[(0,t.jsx)(u.V,{name:"phone",width:"md",label:"\u624B\u673A",placeholder:"\u8BF7\u8F93\u5165\u624B\u673A\u53F7"}),(0,t.jsx)(u.V,{width:"md",name:"email",label:"\u90AE\u7BB1",placeholder:"\u8BF7\u8F93\u5165\u90AE\u7BB1",rules:[{type:"email",message:"\u8BF7\u8F93\u5165\u90AE\u7BB1!"}]}),(0,t.jsx)(C.FQ,{name:"deptId",width:"md",treeData:ge,label:"\u7EC4\u7EC7\u673A\u6784",placeholder:"\u8BF7\u9009\u62E9\u7EC4\u7EC7\u673A\u6784",value:m==null?void 0:m.deptId}),(0,t.jsx)(u._I,{mode:"tags",request:(0,V.Z)((0,K.Z)().mark(function c(){return(0,K.Z)().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.abrupt("return",I.hi.loadRoles({current:1,pageSize:1024}).then(function(f){return f.list.map(function(n){return{label:n.name,value:n.id}})}));case 1:case"end":return x.stop()}},c)})),width:"md",name:"roles",label:"\u89D2\u8272\u5217\u8868"})]}),(0,t.jsx)(u.ZP.Group,{children:(0,t.jsx)(u.ZP.Item,{label:"\u9009\u62E9\u5C97\u4F4D",name:"userPositions",trigger:"onValuesChange",children:(0,t.jsx)(Y.Z,{rowKey:"id",toolBarRender:!1,columns:Ie,recordCreatorProps:{newRecordType:"dataSource",position:"top",record:function(){return{id:"".concat(Date.now())}}},editable:{type:"multiple",editableKeys:_,onChange:Fe,actionRender:function(F,x,f){return[f.delete]}}})})})]})}),Ee=e(43185),ce=e(28525),Ce=e(69753),je=e(43347),ve=ce.Z.Dragger;function Se(z){var Q=z.onCancel,m=z.onOk,fe=(0,v.useState)(!1),le=(0,o.Z)(fe,2),H=le[0],k=le[1],me=(0,v.useState)([]),$=(0,o.Z)(me,2),se=$[0],b=$[1],he={multiple:!1,accept:".xlsx",beforeUpload:function(_){return b([_]),!1},onRemove:function(){b([])},maxCount:1};return(0,t.jsx)(l.Z,{title:"\u6279\u91CF\u5BFC\u5165\u7528\u6237",onCancel:Q,open:!0,maskClosable:!1,footer:[(0,t.jsx)(N.Z,{onClick:Q,children:"\u53D6\u6D88"},"cancel"),(0,t.jsx)(N.Z,{icon:(0,t.jsx)(Ce.Z,{}),onClick:function(){I.hi.download("/api/file/downloadTemplate?name=\u5377\u738B\u7528\u6237\u5BFC\u5165\u6A21\u677F")},children:"\u4E0B\u8F7D\u6A21\u677F"},"downloadTemplate"),(0,t.jsx)(N.Z,{icon:(0,t.jsx)(s.Z,{}),type:"primary",loading:H,onClick:function(){if(se.length===0){W.default.error("\u8BF7\u9009\u62E9\u6587\u4EF6");return}k(!0),I.hi.upload("/api/importUser",{file:se[0]},function(_){}).then(function(_){k(!1),_.success?(W.default.success("\u5BFC\u5165\u6210\u529F"),m()):W.default.error(_.message)})},children:"\u5BFC\u5165"},"importTemplate")],children:(0,t.jsxs)(ve,(0,p.Z)((0,p.Z)({},he),{},{children:[(0,t.jsx)("p",{className:"ant-upload-drag-icon",children:(0,t.jsx)(je.Z,{})}),(0,t.jsx)("p",{className:"ant-upload-text",children:"\u70B9\u51FB\u6216\u8005\u62D6\u62FDExcel\u6587\u4EF6\u5230\u6B64\u5904"})]}))})}var Be=["magenta","volcano","cyan","blue","geekblue","purple"],Re=(0,E.Pi)(function(){var z=(0,I.m2)(),Q=(0,v.useRef)(),m=(0,v.useRef)(),fe=(0,v.useState)(),le=(0,o.Z)(fe,2),H=le[0],k=le[1],me=(0,v.useState)(!1),$=(0,o.Z)(me,2),se=$[0],b=$[1],he=(0,v.useState)(),q=(0,o.Z)(he,2),_=q[0],Fe=q[1];(0,v.useEffect)(function(){z.loadPermissions()},[z]);var ge=[{title:"\u7EC4\u7EC7\u673A\u6784",dataIndex:"deptName",hideInSearch:!0,width:150},{title:"\u59D3\u540D",dataIndex:"name",ellipsis:!0,width:120},{title:"\u89D2\u8272",dataIndex:"role",hideInSearch:!0,width:150,renderFormItem:function(n,i){var g=i.defaultRender;return g(n)},render:function(n,i){var g;return(0,t.jsx)(X.Z,{children:(g=i.roles)===null||g===void 0?void 0:g.filter(function(d){return d}).map(function(d,Ze){return(0,t.jsx)(w.Z,{color:Be[Ze],children:d.name},d.id)})})}},{title:"\u624B\u673A",dataIndex:"phone",width:150,search:!1},{title:"\u72B6\u6001",dataIndex:"status",search:!1,width:100,valueEnum:{0:{text:"\u5931\u6D3B",status:"Default"},1:{text:"\u6FC0\u6D3B",status:"Processing"}}},{title:"\u521B\u5EFA\u65F6\u95F4",key:"showTime",dataIndex:"createAt",width:150,valueType:"dateTime",hideInSearch:!0},{title:"\u64CD\u4F5C",valueType:"option",width:140,dataIndex:"setting",fixed:"right",render:function(n,i){return[(0,t.jsx)("a",{onClick:function(){k({visible:!0,current:i})},children:"\u7F16\u8F91"},"editable"),(0,t.jsx)(ae.Z,{overlay:(0,t.jsx)(de.Z,{onClick:function(d){var Ze=d.key;if(Ze==="resetPwd")l.Z.confirm({title:"\u91CD\u7F6E\u5BC6\u7801",content:(0,t.jsx)(G.Z.Password,{placeholder:"\u8F93\u5165\u5BC6\u7801",onChange:function(pe){return m.current=pe.target.value}}),okType:"primary",okText:"\u4FEE\u6539",cancelText:"\u53D6\u6D88",onOk:function(pe){return m.current?(I.hi.updateUser({id:i.id,password:m.current}).then(function(xe){xe.success&&(W.default.success("\u4FEE\u6539\u6210\u529F"),m.current=void 0,pe())}),!1):(W.default.error("\u8BF7\u8F93\u5165\u5BC6\u7801"),!1)}});else if(Ze==="delete"){if(i.id==="1"){l.Z.info({title:"\u63D0\u793A",content:"\u5185\u7F6E\u7528\u6237\u4E0D\u80FD\u5220\u9664"});return}l.Z.confirm({title:"\u5220\u9664\u7528\u6237",content:"\u786E\u5B9A\u5220\u9664\u5F53\u524D\u7528\u6237\u5417\uFF1F",okType:"danger",okText:"\u5220\u9664",cancelText:"\u53D6\u6D88",onOk:function(){z.deleteUser(i.id).then(function(pe){if(pe.success){var xe;W.default.success("\u5220\u9664\u6210\u529F"),(xe=Q.current)===null||xe===void 0||xe.reload()}})}})}},items:[{label:"\u91CD\u7F6E\u5BC6\u7801",key:"resetPwd"},{label:"\u5220\u9664\u7528\u6237",key:"delete"}]}),children:(0,t.jsxs)("a",{className:"ant-dropdown-link",onClick:function(d){return d.preventDefault()},children:["\u66F4\u591A",(0,t.jsx)(P.Z,{})]})},"action")]}}],Ie=(0,v.useState)([]),c=(0,o.Z)(Ie,2),F=c[0],x=c[1];return(0,t.jsxs)(O._z,{title:!1,children:[(0,t.jsxs)(ne.Z,{gutter:20,children:[(0,t.jsx)(L.Z,{xs:0,md:6,children:(0,t.jsx)(R.A,{onSelect:function(n){return Fe(n)}})}),(0,t.jsxs)(L.Z,{xs:24,md:18,children:[(0,t.jsx)(y.ZP,{columns:ge,bordered:!0,actionRef:Q,params:{deptId:_},request:function(){var f=(0,V.Z)((0,K.Z)().mark(function n(i){return(0,K.Z)().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",z.loadUsers(i));case 1:case"end":return d.stop()}},n)}));return function(n){return f.apply(this,arguments)}}(),rowSelection:{selections:[J.Z.SELECTION_ALL,J.Z.SELECTION_INVERT],selectedRowKeys:F,onChange:function(n,i,g){x(n)}},tableAlertRender:function(n){var i=n.selectedRowKeys,g=n.selectedRows,d=n.onCleanSelected;return(0,t.jsx)(X.Z,{size:24,children:(0,t.jsxs)("span",{children:["\u5DF2\u9009 ",i.length," \u9879",(0,t.jsx)("a",{style:{marginInlineStart:8},onClick:d,children:"\u53D6\u6D88\u9009\u62E9"})]})})},tableAlertOptionRender:function(){return(0,t.jsx)(X.Z,{size:16,children:(0,t.jsx)("a",{onClick:function(){l.Z.confirm({title:"\u6279\u91CF\u5220\u9664",content:"\u786E\u5B9A\u5220\u9664\u9009\u62E9\u7684\u7528\u6237\u5417\uFF1F",onOk:function(){z.deleteUser(F.join(",")).then(function(g){if(g.success){var d;W.default.success("\u5220\u9664\u6210\u529F"),(d=Q.current)===null||d===void 0||d.reload()}})}})},children:"\u6279\u91CF\u5220\u9664"})})},rowKey:"id",search:{labelWidth:"auto"},pagination:{defaultPageSize:10,showSizeChanger:!0},scroll:{x:900},dateFormatter:"string",headerTitle:"\u7CFB\u7EDF\u7528\u6237\u5217\u8868",toolBarRender:function(){return[(0,t.jsx)(N.Z,{icon:(0,t.jsx)(r.Z,{}),type:"primary",onClick:function(){k({visible:!0})},children:"\u65B0\u5EFA"},"button"),(0,t.jsx)(N.Z,{icon:(0,t.jsx)(s.Z,{}),type:"primary",onClick:function(){b(!0)},children:"\u6279\u91CF\u5BFC\u5165"},"import")]}}),(H==null?void 0:H.visible)&&(0,t.jsx)(ye,{onClose:function(){k(void 0)},onOk:function(){var n;k(void 0),(n=Q.current)===null||n===void 0||n.reload()},user:H.current})]})]}),se&&(0,t.jsx)(Se,{onCancel:function(){return b(!1)},onOk:function(){var n;b(!1),(n=Q.current)===null||n===void 0||n.reload()}})]})}),Te=Re}}]);
